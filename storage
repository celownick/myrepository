stages:
  - setup
  - test

mount-logs:
  stage: setup
  before_script:
    - apt-get update && apt-get install -y cifs-utils  # 📌 Instalacja pakietu dla CIFS/SMB
  script:
    - echo "🔗 Montowanie zasobu \\groupshare\logs w /mnt/logs..."
    - mkdir -p /mnt/logs
    - mount -t cifs //groupshare/logs /mnt/logs -o username=DOMAIN/USERNAME,password=PASSWORD,vers=3.0
    - ls -la /mnt/logs
  only:
    - merge_requests
    - schedules
    - pipelines

run-tests:
  stage: test
  script:
    - echo "🔍 Sprawdzanie logów..."
    - cat /mnt/logs/test.log || echo "❌ Plik nie znaleziony!"
  dependencies:
    - mount-logs
